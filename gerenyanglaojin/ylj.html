<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/yyylj.css">
    <title>个人养老金计算器</title>
    <style>
         body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: white;
        }

        .container {
            margin: 0 auto;
            max-width: 1220px;
            padding: 12px;
        }

        .title {
            font-family: "宋体" , sans-serif;
            text-align: center;
            font-size: 32px;
            color: rgb(49, 49, 51);
            letter-spacing: 4px;
            position: relative;
        }
        

        .title::before,
        .title::after {
            content: '';
            position: absolute;
            top: 23%;
            width: 20px;
            height: 2px;
        }

        .title::before {
            left: 430px; 
            margin-top: 10px;
            
        }

        .title::after {
            right: 430px;
            margin-top: 9px;
        }

        p {
            text-align: center;
            color: #313133;
            font-size: 14px;
        }

        .se-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 15px 0;
        }

        .image {
            max-width: 400px;
            margin-right: 20px;
        }

        .image img {
            width: 100%;
            height: auto;
        }

        .form-container {
            width: 710px;
            height:588px;
            background-color: #fff;
            padding-left: 88px;
            border: 1px solid #ddd;
            /* margin-left: 10px; */
            padding-top: 40px;
        }

        .form-container h2 {
            margin-top: 0;
            font-size: 24px;
            color: #333;
        }

        .form-group {
            padding-bottom: 25px;
            display: flex;
            align-items: center;
        }

        .form-group label {
            width: 175px;
            font-size: 15px;
            color: #070707;
            line-height: 24px;
            margin-right: 16px;
            margin-left: 80px;
            display: flex;
            align-items: center;
            height: 48px;
        }
        

        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group select {
            background: #f4f7fc;
            border: 0;
            padding: 10px;
            height: 48px;
            outline: none;
            font-size: 16px;
            line-height: 24px;
            color: black;
        }

        /* 单独设置每个输入框的宽度 */
        #age {
            width: 300px;
            height: 30px;
        }

        #retirement-age {
            width: 320px;
            height: 50px;
            color: black;
        }

        #income {
            width: 300px;
            height: 34px;
            color: black;
        }

        #tax-rate {
            width: 322px;
            height: 50px;
            margin-left: 0px;
            color: black;
        }

        #investment {
            width: 304px;
            height: 35px;
        }

        #rate-of-return {
            width: 323px;
            height: 46px;
            color: black;
            margin: 0;
        }

        .investment-input-container {
            position: relative;
        }

        .investment-input-container::after {
            content: '养老金存入限额要求，最高不超过12000元';
            position: absolute;
            left: 0;
            bottom: -20px;
            font-size: 14px;
            color: #b3b1b1;
        }

        .calculate-button {
            display: block;
            width: 323px;
            height: 52px;
            padding: 10px;
            background-color: #0056b3;
            color: #fff;
            border: none;
            /* cursor: pointer; */
            font-size: 17px;
            margin: 20px 0px 0px 273px;
        }
        /* footer {
            width: 100%;
            color: #b1abab;
        } */
        .p1 {
            text-align: left;
            line-height: 6px;
            font-size: 12px;
            color: #999;
        }
        .p2 {
            text-align: left;
            /* line-height: 1; */
            font-size: 12px;
            color: #999;
            margin-top: 26px;
            
        }

        .age-input-container {
            position: relative;
        }

        .age-input-container::after {
            content: '有效年龄范围18～65周岁';
            position: absolute;
            left: 0;
            bottom: -20px;
            font-size: 14px;
            color: #b3b1b1;
        }

        /* 隐藏输入框的上下箭头 */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            -moz-appearance: textfield; /* Firefox */
        }

    </style>
</head>

<body>
    <div class="container">
        <h2 class="title">-个人养老金计算器-</h2>
        <p>算一算，体面养老需要多少钱？</p>
        <div class="se-container">
            <div class="image">
                <img src="./img/program.png" alt="老年人查看文件">
            </div>
            <div class="form-container">
                <div class="form-group">
                    <label>我的年龄（周岁）</label>
                    <div class="age-input-container">
                        <input type="text" id="age" placeholder="请输入我的年龄（周岁）">
                    </div>
                </div>
                <div class="form-group">
                    <label>期望退休年龄（周岁）</label>
                    <select id="retirement-age">
                        <option>60</option>
                        <option>55</option>
                        <option>65</option>
                    </select>
                </div>
                <div class="form-group">
                    <label style="margin-top: -7px;">当前税前年收入（元）</label>
                    <input type="number" id="income"  placeholder="请输入当前税前年收入（元）" >
                </div>
                <div class="form-group">
                    <label>当前个人所得税最高税率</label>
                    <select id="tax-rate">
                        <option>请选择</option>
                        <option>10%</option>
                        <option>20%</option>
                        <option>30%</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>每年投资养老基金（元）</label>
                    <div class="investment-input-container">
                        <input type="number" id="investment" placeholder="每年投资养老基金（元）">
                    </div>
                </div>
                <div class="form-group">
                    <label>期望年化收益率</label>
                    <select id="rate-of-return">
                        <option>4.0%</option>
                        <option>3.0%</option>
                        <option>5.0%</option>
                    </select>
                </div>
                <button class="calculate-button" onclick="calculate()">计算</button>
            </div>
        </div>
        <footer>
            <p class="p1">
                年化收益率默认值4%是根据养老目标基金近15年回测的平均年化收益率计算得出，过往业绩不代表未来表现。
                为便于投资者评估未来市场，该收益率支持修改，年化收益率仅为投资者基于本人对养老基金的未来预判而自行设置的
            </p>
            <p class="p1">用于养老投资收益计算的假设条件。广发证券不保证盈利和最低收益，投资有风险，应谨慎至上。</p>
            <p class="p2">
                免责声明：
            </p>
            <p class="p1">
                1、个人养老金计算器所使用的算法存在诸多假设。而目由于数据源、算法等存在一定的局限性，本服务可能无法涵盖市场上所有的数据，所展示的信息也可能存在一定的误差。
            </p>
            <p class="p1">
                2、由于可能存在数据获取及同步问题，可能出现未能根据最新的税率政策及时更新算法条件，导致计算结果出现偏差。
            </p>
            <!-- <p class="p1">
                3、本服务提供的信息是广发证券根据官方公布的税率数据、您自行设置的数值、假设条件及相关算法自动计算得出，仅对相关数据进行客观展示，并非是对未来收入和收益的预测，不代表养老计划真实业绩或未来业绩预测，不构成
            </p>
            <p class="p1">任何投资建议，也不对投资收益进行任何保证和承诺。
                无论是否使用本服务，您均应自主作出投资决策并独自承担投资风险。</p> -->
        </footer>
    </div>
    <script>
        function calculate() {
            // 获取用户输入的值
            const age = parseInt(document.getElementById('age').value);
            const retirementAge = parseInt(document.getElementById('retirement-age').value);
            const income = parseFloat(document.getElementById('income').value);
            const taxRateStr = document.getElementById('tax-rate').value;
            const investment = parseFloat(document.getElementById('investment').value);
            const rateOfReturnStr = document.getElementById('rate-of-return').value;
            
            // 处理税率和收益率（去掉百分号并转为小数）
            const taxRate = parseFloat(taxRateStr) / 100 || 0;
            const rateOfReturn = parseFloat(rateOfReturnStr) / 100 || 0;
            
            // 验证所有字段都已填写
            if (!document.getElementById('age').value) {
                alert('请输入您的年龄');
                return;
            }
            
            if (!document.getElementById('retirement-age').value) {
                alert('请选择期望退休年龄');
                return;
            }
            
            if (!document.getElementById('income').value) {
                alert('请输入当前税前年收入');
                return;
            }
            
            if (taxRateStr === '请选择') {
                alert('请选择当前个人所得税最高税率');
                return;
            }
            
            if (!document.getElementById('investment').value) {
                alert('请输入每年投资养老基金金额');
                return;
            }
            
            if (!document.getElementById('rate-of-return').value) {
                alert('请选择期望年化收益率');
                return;
            }
            
            // 验证输入值的有效性
            if (isNaN(age) || age < 18 || age > 65) {
                alert('请输入有效的年龄（18-65周岁）');
                return;
            }
            
            if (isNaN(income) || income <= 0) {
                alert('请输入有效的年收入');
                return;
            }
            
            if (isNaN(investment) || investment <= 0 || investment > 12000) {
                alert('请输入有效的养老金投资金额（不超过12000元）');
                return;
            }
            
            // 计算投资年数
            const investmentYears = retirementAge - age;
            
            // 参加个人养老金计划的计算
            // 累计投入本金
            const totalInvestment = investment * investmentYears;
            
            // 计算累计投资收益（复利）
            let totalReturn = 0;
            for (let i = 0; i < investmentYears; i++) {
                totalReturn += investment * Math.pow(1 + rateOfReturn, investmentYears - i) - investment;
            }
            
            // 账户累计金额
            const totalAmount = totalInvestment + totalReturn;
            
            // 退休后一次性领取养老金，按照3%税率纳税
            const afterTaxAmount = totalAmount * (1 - 0.03);
            
            // 每年节省的个税
            const yearlyTaxSaving = investment * taxRate;
            
            // 累计节省个税
            const totalTaxSaving = yearlyTaxSaving * investmentYears;
            
            // 不参加个人养老金计划的计算
            // 扣税后的本金
            const afterTaxInvestment = investment * (1 - taxRate);
            
            // 累计投入本金（不参加计划）
            const totalAfterTaxInvestment = afterTaxInvestment * investmentYears;
            
            // 计算累计投资收益（不参加计划）
            let totalAfterTaxReturn = 0;
            for (let i = 0; i < investmentYears; i++) {
                totalAfterTaxReturn += afterTaxInvestment * Math.pow(1 + rateOfReturn, investmentYears - i) - afterTaxInvestment;
            }
            
            // 账户累计金额（不参加计划）
            const totalAfterTaxAmount = totalAfterTaxInvestment + totalAfterTaxReturn;
            
            // 将计算结果存储在URL参数中
            const params = new URLSearchParams();
            params.append('age', age);
            params.append('retirementAge', retirementAge);
            params.append('income', income);
            params.append('taxRate', taxRate);
            params.append('investment', investment);
            params.append('rateOfReturn', rateOfReturn);
            params.append('totalInvestment', totalInvestment.toFixed(2));
            params.append('totalReturn', totalReturn.toFixed(2));
            params.append('totalAmount', totalAmount.toFixed(2));
            params.append('afterTaxAmount', afterTaxAmount.toFixed(2));
            params.append('yearlyTaxSaving', yearlyTaxSaving.toFixed(2));
            params.append('totalTaxSaving', totalTaxSaving.toFixed(2));
            params.append('afterTaxInvestment', afterTaxInvestment.toFixed(2));
            params.append('totalAfterTaxInvestment', totalAfterTaxInvestment.toFixed(2));
            params.append('totalAfterTaxReturn', totalAfterTaxReturn.toFixed(2));
            params.append('totalAfterTaxAmount', totalAfterTaxAmount.toFixed(2));
            
            // 在当前页面跳转到结果页面
            window.location.href = `yyylj.html?${params.toString()}`;
        }

        // document.addEventListener('DOMContentLoaded', function() {
        //     const ageInput = document.getElementById('age');
        //     const retirementAgeSelect = document.getElementById('retirement-age');
        //     const incomeInput = document.getElementById('income');
        //     const taxRateSelect = document.getElementById('tax-rate');
        //     const investmentInput = document.getElementById('investment');
        //     const rateOfReturnSelect = document.getElementById('rate-of-return');
        //     const calculateButton = document.querySelector('.calculate-button');
            
        //     function checkAllFieldsFilled() {
        //         const isTaxRateValid = taxRateSelect.value !== '请选择';
                
        //         if (ageInput.value && 
        //             retirementAgeSelect.value && 
        //             incomeInput.value && 
        //             isTaxRateValid && 
        //             investmentInput.value && 
        //             rateOfReturnSelect.value) {
        //             calculateButton.style.backgroundColor = '#0056b3';
        //         } else {
        //             calculateButton.style.backgroundColor = '#99b5f3';
        //         }
        //     }
            
        //     // 为每个输入字段添加事件监听器
        //     ageInput.addEventListener('input', checkAllFieldsFilled);
        //     retirementAgeSelect.addEventListener('change', checkAllFieldsFilled);
        //     incomeInput.addEventListener('input', checkAllFieldsFilled);
        //     taxRateSelect.addEventListener('change', checkAllFieldsFilled);
        //     investmentInput.addEventListener('input', checkAllFieldsFilled);
        //     rateOfReturnSelect.addEventListener('change', checkAllFieldsFilled);
            
        //     // 初始检查
        //     checkAllFieldsFilled();
        // });
    </script>
</body>

</html>